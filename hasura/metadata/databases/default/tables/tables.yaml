version: 3
sources:
- name: default
  kind: postgres
  configuration:
    connection_info:
      use_prepared_statements: true
      database_url:
        from_env: HASURA_GRAPHQL_DATABASE_URL
      isolation_level: read-committed
      pool_settings:
        connection_lifetime: 600
        retries: 1
        idle_timeout: 180
        max_connections: 50
  tables:
  - table:
      schema: public
      name: categories
    object_relationships:
    - name: products
      using:
        foreign_key_constraint_on:
          column: category_id
          table:
            schema: public
            name: products
    select_permissions:
    - role: public
      permission:
        columns:
        - category_id
        - category_name
        - description
        - created_at
        - updated_at
        filter: {}
  - table:
      schema: public
      name: customers
    object_relationships:
    - name: orders
      using:
        foreign_key_constraint_on:
          column: customer_id
          table:
            schema: public
            name: orders
    select_permissions:
    - role: public
      permission:
        columns:
        - customer_id
        - company_name
        - contact_name
        - contact_title
        - address
        - city
        - region
        - postal_code
        - country
        - phone
        - fax
        - email
        - registration_date
        - customer_type
        - credit_limit
        - created_at
        - updated_at
        filter: {}
  - table:
      schema: public
      name: employees
    object_relationships:
    - name: manager
      using:
        foreign_key_constraint_on: reports_to
    - name: orders
      using:
        foreign_key_constraint_on:
          column: employee_id
          table:
            schema: public
            name: orders
    array_relationships:
    - name: subordinates
      using:
        foreign_key_constraint_on:
          column: reports_to
          table:
            schema: public
            name: employees
    select_permissions:
    - role: public
      permission:
        columns:
        - employee_id
        - last_name
        - first_name
        - title
        - title_of_courtesy
        - birth_date
        - hire_date
        - address
        - city
        - region
        - postal_code
        - country
        - home_phone
        - extension
        - notes
        - reports_to
        - salary
        - commission
        - created_at
        - updated_at
        filter: {}
  - table:
      schema: public
      name: order_details
    object_relationships:
    - name: order
      using:
        foreign_key_constraint_on: order_id
    - name: product
      using:
        foreign_key_constraint_on: product_id
    select_permissions:
    - role: public
      permission:
        columns:
        - order_id
        - product_id
        - unit_price
        - quantity
        - discount
        - line_total
        - created_at
        filter: {}
  - table:
      schema: public
      name: orders
    object_relationships:
    - name: customer
      using:
        foreign_key_constraint_on: customer_id
    - name: employee
      using:
        foreign_key_constraint_on: employee_id
    - name: shipper
      using:
        foreign_key_constraint_on: ship_via
    array_relationships:
    - name: order_details
      using:
        foreign_key_constraint_on:
          column: order_id
          table:
            schema: public
            name: order_details
    select_permissions:
    - role: public
      permission:
        columns:
        - order_id
        - customer_id
        - employee_id
        - order_date
        - required_date
        - shipped_date
        - ship_via
        - freight
        - ship_name
        - ship_address
        - ship_city
        - ship_region
        - ship_postal_code
        - ship_country
        - order_status
        - payment_method
        - discount_percent
        - tax_amount
        - created_at
        - updated_at
        filter: {}
  - table:
      schema: public
      name: products
    object_relationships:
    - name: category
      using:
        foreign_key_constraint_on: category_id
    - name: supplier
      using:
        foreign_key_constraint_on: supplier_id
    array_relationships:
    - name: order_details
      using:
        foreign_key_constraint_on:
          column: product_id
          table:
            schema: public
            name: order_details
    select_permissions:
    - role: public
      permission:
        columns:
        - product_id
        - product_name
        - supplier_id
        - category_id
        - quantity_per_unit
        - unit_price
        - units_in_stock
        - units_on_order
        - reorder_level
        - discontinued
        - created_at
        - updated_at
        filter: {}
  - table:
      schema: public
      name: shippers
    array_relationships:
    - name: orders
      using:
        foreign_key_constraint_on:
          column: ship_via
          table:
            schema: public
            name: orders
    select_permissions:
    - role: public
      permission:
        columns:
        - shipper_id
        - company_name
        - phone
        - email
        - website
        - base_shipping_cost
        - created_at
        - updated_at
        filter: {}
  - table:
      schema: public
      name: suppliers
    array_relationships:
    - name: products
      using:
        foreign_key_constraint_on:
          column: supplier_id
          table:
            schema: public
            name: products
    select_permissions:
    - role: public
      permission:
        columns:
        - supplier_id
        - company_name
        - contact_name
        - contact_title
        - address
        - city
        - region
        - postal_code
        - country
        - phone
        - fax
        - homepage
        - created_at
        - updated_at
        filter: {}
